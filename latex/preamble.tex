% fonts
\usepackage[T1]{fontenc}
\usepackage{inconsolata}
\usepackage[charter]{mathdesign}

%font alternatives:
%\usepackage[mathlf]{MinionPro}
%\usepackage[utopia]{mathdesign}

\usepackage[kerning,spacing,stretch=10]{microtype}
\microtypecontext{spacing=nonfrench}

\usepackage[nottoc]{tocbibind}

\interfootnotelinepenalty=10000

% miscellaneous packages
\usepackage[table]{xcolor}
\usepackage{float}
\usepackage[hyperindex,colorlinks]{hyperref}
\usepackage{verbatim}
\usepackage{siunitx}
\usepackage{todonotes}
\usepackage{placeins}
\usepackage{booktabs}
\usepackage{graphicx}
\usepackage{etoolbox}
\usepackage{expl3}
\usepackage{path}
\usepackage{xspace}
\usepackage{amsmath}
\usepackage{subfig}
\usepackage{xstring}

\usepackage{longtable}

\usepackage{datetime}

\usepackage{multirow}

\usdate

%\newdateformat{newdateformat}{\THEMONTH} \THEDAY \THEYEAR}
%\customdateformat

% date typesetting command
\newcommand{\dt}[3]{\formatdate{#1}{#2}{#3}}


\usepackage[shortlabels]{enumitem}

% exercises.
\usepackage{exercise,chngcntr}
\counterwithin{Exercise}{chapter}
\counterwithin{Answer}{chapter}

\usepackage{caption}
\captionsetup{
  margin=10pt,
  font=small,
  labelfont=bf,
  labelsep=endash,
  format=hang
}

% references
\usepackage[sorting=none]{biblatex}


% tikz
\usepackage{tikz}
\usetikzlibrary{
  shapes,backgrounds,decorations.pathreplacing,
  positioning,fit,shadings,fadings,matrix,calc,patterns, shapes.multipart}

\newenvironment{indentpar}[1][1cm]%
{\begin{list}{}%
    {\setlength{\leftmargin}{#1}}%
  \item[]%
  }
  {\end{list}}

% algorithms typesetting.
\usepackage[chapter]{algorithm}
\usepackage{algpseudocode}

\newcommand{\commentsymbol}{$\triangleright$}
\algrenewcommand{\algorithmiccomment}[1]{\hfill\commentsymbol#1}
\newcommand{\linecomment}[1]{\State\commentsymbol#1}

\algrenewcommand\alglinenumber[1]{
  \tt\footnotesize\textcolor[HTML]{888888}{#1}}

\newcommand*\Let[2]{\State #1 $\gets$ #2}

\algblockdefx[REPEATN]
{Repeatn}
{EndRepeatn}
[1]{\algorithmicrepeat\ #1 \ \algorithmicdo}
{\algorithmicend \ \algorithmicrepeat}

\algnewcommand\algorithmicforeach{\textbf{for each}}

\newcommand{\algto}{\textbf{to}}

\algblockdefx[FOREACH]
{ForEach}
{EndForEach}
[2]{\algorithmicforeach \ #1 \ \textbf{in} \ #2 \algorithmicdo}
{\algorithmicend \ \algorithmicforeach}

\newcommand{\Break}{\State \textbf{break}}
\newcommand{\VoidCall}[1]{ \Call{#1}{\ensuremath{}}}
\newcommand{\ForTo}[3]{\For{ #1 $\gets$ #2 \algto\  #3}}

\newcommand{\EndForTo}{\EndFor}

\newcommand{\Ret}[1]{\State \textbf{return} #1}


\newcommand{\Dec}[2]{\State \Call{Dec}{\ensuremath{#1,#2}}}
\newcommand{\Inc}[2]{\State \Call{Inc}{\ensuremath{#1,#2}}}

% miscellaneous configurations
%\pagestyle{headings}

\usepackage{fancyhdr}
\pagestyle{fancy}

\fancypagestyle{plain}{%
\fancyhf{} % clear all header and footer fields
\renewcommand{\headrulewidth}{0pt}
\renewcommand{\footrulewidth}{0pt}}

% macros

\newcommand{\inputtikz}[1]{\input{tikz_img/#1}}

\newcommand{\True}{\textbf{true}\xspace}
\newcommand{\False}{\textbf{false}\xspace}
\newcommand{\NOT}{\neg}
\newcommand{\AND}{\wedge}
\newcommand{\OR}{\vee}
\newcommand{\mul}{\ensuremath{\cdot}}

\newcommand*\BitAnd{\mathrel{\&}}
\newcommand*\BitOr{\mathrel{|}}
\newcommand*\BitXor{\mathrel{\otimes}}
\newcommand*\ShiftLeft{\ll}
\newcommand*\ShiftRight{\gg}
\newcommand*\BitNeg{\ensuremath{\mathord{\sim}}}

% Fixes list of algorithms formatting.
% Thanks Dan: http://newsgroups.derkeiler.com/Archive/Comp/comp.text.tex/2005-10/msg01179.html
\makeatletter
\let\l@algorithm\l@figure
\makeatother

\renewcommand{\listofalgorithms}{\begingroup
\tocfile{List of Algorithms}{loa}
\endgroup}


\newcommand*{\tikzname}{Ti\emph{k}Z\xspace}

\newcommand{\fullbyte}{$11111111$\xspace}
\newcommand{\emptybyte}{$00000000$\xspace}

% Thanks to Philip and Konrad Rudolph:
% http://tex.stackexchange.com/questions/2933/parse-comma-separated-list-of-command-names-with-spaces

\newcommand*\acronymstyle{\scshape}
\newcommand*\newacronym[1]{
  \expandafter\newcommand\csname#1\endcsname[1][]{{\acronymstyle#1}##1\xspace}}

\newcommand*{\newacronyms}{%
  \let\do\newacronym
  \docsvlist
}
\newacronyms{C,pgf}

\newcommand{\eof}{\ensuremath{\VoidCall{EndOfFileReached}}}
\newcommand{\neof}{\ensuremath{\NOT \VoidCall{EndOfFileReached}}}

\newcommand{\lzseven}{LZ77\xspace}
\newcommand{\lzeight}{LZ78\xspace}

\newcommand{\hex}[1]{\ensuremath{\mathrm{0x#1}}}
\newcommand{\bin}[1]{\mbox{\ensuremath{#1}}}

\newcommand{\answers}{\section{Answers to the exercises}}

% LZ77 demonstration macros.

\ExplSyntaxOn
\cs_new_eq:NN \explRepeat \prg_replicate:nn
\ExplSyntaxOff

\makeatletter

\def\@filling#1{\phantom{\explRepeat{#1}{a}}}

\newcommand\@buffers[4]{%
  \node[
  rectangle split,
  rectangle split parts=2,
  draw,
  anchor=text,
  rectangle split horizontal]{%
    \@filling{#1}\texttt{#2}\nodepart{two}\texttt{#3}\@filling{#4}}
}

\newcommand{\@lzonestate}[2]{%
  \StrLen{#1}[\lena]%
  \newcount\cnta%
  \cnta\lena\relax%
  \advance\cnta by -\windowsize\relax
  \typeout{cnta: \the\cnta}
  \StrLen{#2}[\lenb]%
  \newcount\cntb%
  \cntb\lenb\relax%
  \advance\cntb by -\lookaheadsize\relax
  \@buffers{-\cnta}{#1}{#2}{-\cntb}
}

\newcommand\lzonetoken[3]{$(#1,#2,$\,{\tt#3}$)$}
\newcommand\lzonetokens[1]{\lzonetoken{0}{0}{#1}}


\newcommand{\lzonestate}[5]{%
\@lzonestate{#1}{#2}; \& \node[yshift=1mm]{$\Rightarrow$\lzonetoken{#3}{#4}{#5}}; \\}

\newcommand{\lzonestates}[3]{%
\@lzonestate{#1}{#2}; \& \node[yshift=1mm]{$\Rightarrow$ \lzonetokens{#3}}; \\}


\def\lzonedem#1{%
  \begin{center}
  \begin{tikzpicture}[text height=1.5ex,text depth=.25ex]
    \matrix[ampersand replacement=\&,row sep=5mm]{#1};
  \end{tikzpicture}
  \end{center}}

\makeatother

\newcommand{\spc}{\char32}

